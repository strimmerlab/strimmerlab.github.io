<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13&nbsp; Conditioning and Bayes rule – Statistics 2: Statistical Learning with Likelihood and Bayes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-bayes2.html" rel="next">
<link href="./12-likelihood6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bf90d58e07b16a5a5517af5259b97af0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13-bayes1.html">Bayesian statistics</a></li><li class="breadcrumb-item"><a href="./13-bayes1.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conditioning and Bayes rule</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics 2: Statistical Learning with Likelihood and Bayes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Entropy and likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Statistical learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-intro2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-entropy1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Entropy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-entropy2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Divergence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-entropy3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fisher information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-entropy4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Maximum entropy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-likelihood1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Principle of maximum likelihood</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-likelihood2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Maximum likelihood estimation in practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-likelihood3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Observed Fisher information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-likelihood4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Quadratic approximation and normal asymptotics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-likelihood5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Likelihood-based confidence interval and likelihood ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-likelihood6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Optimality properties and conclusion</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayesian statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-bayes1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conditioning and Bayes rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-bayes2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Models with latent variables and missing data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-bayes3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Essentials of Bayesian statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-bayes4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Bayesian learning in practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-bayes5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Bayesian model comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-bayes6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Choosing priors in Bayesian analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-bayes7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Optimality properties and summary</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bibliography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Statistics refresher</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-further-study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Further study</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#conditional-probability" id="toc-conditional-probability" class="nav-link active" data-scroll-target="#conditional-probability"><span class="header-section-number">13.1</span> Conditional probability</a></li>
  <li><a href="#bayes-theorem" id="toc-bayes-theorem" class="nav-link" data-scroll-target="#bayes-theorem"><span class="header-section-number">13.2</span> Bayes’ theorem</a></li>
  <li><a href="#conditional-mean-and-variance" id="toc-conditional-mean-and-variance" class="nav-link" data-scroll-target="#conditional-mean-and-variance"><span class="header-section-number">13.3</span> Conditional mean and variance</a></li>
  <li><a href="#conditional-entropy-and-entropy-chain-rules" id="toc-conditional-entropy-and-entropy-chain-rules" class="nav-link" data-scroll-target="#conditional-entropy-and-entropy-chain-rules"><span class="header-section-number">13.4</span> Conditional entropy and entropy chain rules</a>
  <ul class="collapse">
  <li><a href="#conditional-entropy" id="toc-conditional-entropy" class="nav-link" data-scroll-target="#conditional-entropy">Conditional entropy</a></li>
  <li><a href="#conditional-cross-entropy" id="toc-conditional-cross-entropy" class="nav-link" data-scroll-target="#conditional-cross-entropy">Conditional cross-entropy</a></li>
  <li><a href="#conditional-kl-divergence" id="toc-conditional-kl-divergence" class="nav-link" data-scroll-target="#conditional-kl-divergence">Conditional KL divergence</a></li>
  <li><a href="#conditional-boltzmann-entropy" id="toc-conditional-boltzmann-entropy" class="nav-link" data-scroll-target="#conditional-boltzmann-entropy">Conditional Boltzmann entropy</a></li>
  </ul></li>
  <li><a href="#entropy-bounds-for-the-marginal-variables" id="toc-entropy-bounds-for-the-marginal-variables" class="nav-link" data-scroll-target="#entropy-bounds-for-the-marginal-variables"><span class="header-section-number">13.5</span> Entropy bounds for the marginal variables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13-bayes1.html">Bayesian statistics</a></li><li class="breadcrumb-item"><a href="./13-bayes1.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conditioning and Bayes rule</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Conditioning and Bayes rule</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter we review conditional probabilities. Conditional probability is essential for Bayesian statistical modelling.</p>
<section id="conditional-probability" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="conditional-probability"><span class="header-section-number">13.1</span> Conditional probability</h2>
<p>We consider two random variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> and assume a <strong>joint density</strong> (or joint PMF) <span class="math inline">\(p(x,y)\)</span>. By definition <span class="math inline">\(\int_{x,y} p(x,y) dx dy = 1\)</span>.</p>
<p>The <strong>marginal densities</strong> for the individual random variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are given by <span class="math inline">\(p(x) = \int_y p(x,y) dy\)</span> and <span class="math inline">\(p(y) = \int_x f(x,y) dx\)</span>, respectively. Therefore, the marginal densities are derived from the joint density by integrating over all possible states of the variable that is being excluded. As necessary for any density, the marginal densities also integrate to one, i.e. <span class="math inline">\(\int_x p(x) dx = 1\)</span> and <span class="math inline">\(\int_y p(y) dy = 1\)</span>.</p>
<p>As alternative to integrating out a random variable in the joint density <span class="math inline">\(p(x,y)\)</span> we may wish to keep it fixed at some value. For instance we may want to keep <span class="math inline">\(y\)</span> fixed at <span class="math inline">\(y_0\)</span>. In this case <span class="math inline">\(p(x, y=y_0)\)</span> is proportional to the <strong>conditional density</strong> (or PMF) given by the ratio <span class="math display">\[
p(x | y=y_0) = \frac{p(x, y=y_0)}{p(y=y_0)}
\]</span> In this formula the denominator <span class="math inline">\(p(y=y_0) = \int_x p(x, y=y_0) dx\)</span> ensures that <span class="math inline">\(\int_x p(x | y=y_0) dx = 1\)</span>, thus it renormalises <span class="math inline">\(p(x, y=y_0)\)</span> so that it becomes a density integrating to one. To simplify notation, the particular value on which a variable is conditioned is often left out, and we just write <span class="math inline">\(p(x | y)\)</span>.</p>
</section>
<section id="bayes-theorem" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="bayes-theorem"><span class="header-section-number">13.2</span> Bayes’ theorem</h2>
<p><a href="https://de.wikipedia.org/wiki/Thomas_Bayes">Thomas Bayes (1701-1761)</a> was the first to state <a href="https://en.wikipedia.org/wiki/Bayes%27_theorem">Bayes’ theorem</a> on conditional probabilities.</p>
<p>Using the definition of conditional probabilities we see that the joint density can be written as the product of marginal and conditional density in two different ways: <span class="math display">\[
p(x,y) = p(x| y) p(y) = p(y | x) p(x)
\]</span></p>
<p>This directly leads to <strong>Bayes’ theorem</strong>: <span class="math display">\[
p(x | y) = p(y | x) \frac{ p(x) }{ p(y)}
\]</span> This rule relates the two possible conditional densities (or conditional probability mass functions) for the random variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, enabling the change of the order of conditioning.</p>
<p>Bayes’s theorem was <a href="https://en.wikipedia.org/wiki/An_Essay_towards_solving_a_Problem_in_the_Doctrine_of_Chances">published in 1763</a> only after his death by <a href="https://en.wikipedia.org/wiki/Richard_Price">Richard Price (1723-1791)</a>:</p>
<p><a href="https://de.wikipedia.org/wiki/Pierre-Simon_Laplace">Pierre-Simon Laplace</a> independently published Bayes’ theorem in 1774 and he was in fact the first to routinely apply it to statistical calculations.</p>
</section>
<section id="conditional-mean-and-variance" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="conditional-mean-and-variance"><span class="header-section-number">13.3</span> Conditional mean and variance</h2>
<p>The conditional distribution <span class="math inline">\(P_{x|y}\)</span> with density <span class="math inline">\(p(x|y)\)</span> has mean <span class="math inline">\(\operatorname{E}(x| y)\)</span> and variance <span class="math inline">\(\operatorname{Var}(x|y)\)</span>. These are called the <strong>conditional mean</strong> and <strong>conditional variance</strong>, respectively.</p>
<p>The conditional mean <span class="math inline">\(\operatorname{E}(x| y)\)</span> is als denoted by <span class="math inline">\(\operatorname{E}\left( P_{x|y}\right)\)</span> and <span class="math inline">\(\operatorname{E}_{P_{x|y}}(x)\)</span>. It is obtained by calculating <span class="math display">\[
\operatorname{E}(x|y) = \operatorname{E}\left( P_{x|y}\right) =  \operatorname{E}_{P_{x|y}}(x) = \begin{cases}
\sum_{x} p(x|y) \, x &amp; \text{discrete case} \\
\int_{x } p(x| y) \, x \, dx  &amp; \text{continuous case} \\
\end{cases}
\]</span></p>
<p>The conditional variance <span class="math inline">\(\operatorname{Var}(x| y)\)</span> is als denoted by <span class="math inline">\(\operatorname{Var}\left( P_{x|y}\right)\)</span> and <span class="math inline">\(\operatorname{Var}_{P_{x|y}}(x)\)</span>.</p>
<p><span class="math display">\[
\operatorname{Var}(x| y) = \operatorname{Var}\left( P_{x|y}\right) = \operatorname{Var}_{P_{x|y}}(x)
= \operatorname{E}_{P_{x|y}}( (x-\operatorname{E}_{P_{x|y}}(x))^2)    )
= \operatorname{E}( (x-\operatorname{E}(x|y))^2 | y  )
\]</span></p>
<p>The <strong>law of total expectation</strong> links the means of the marginal distribution and of the conditional distributions, stating that <span class="math display">\[
\begin{split}
\operatorname{E}(x) &amp;= \operatorname{E}\left( \operatorname{E}(x| y) \right) \\
&amp;= \operatorname{E}_{P_y} \operatorname{E}_{P_{x| y}}(x)  \\
&amp;= \operatorname{E}_{P_{x,y}} (x)  \\
\end{split}
\]</span> Hence, the total mean (left side) is the weighted average (outer expectation) of the various conditional means (inner expectation).</p>
<p>Similarly, the <strong>law of total variance</strong> states that <span class="math display">\[
\begin{split}
\operatorname{Var}(x) &amp;= \operatorname{Var}(\operatorname{E}(x| y)) + \operatorname{E}(\operatorname{Var}(x|y)) \\
&amp;= \operatorname{Var}_{P_y} \operatorname{E}_{P_{x| y}}(x) + \operatorname{E}_{P_y} \operatorname{Var}_{P_{x|y}}(x)
\end{split}
\]</span> The total variance (left side) decomposes into the “explained” variance or “between-group” variance (first term on right side) and the “unexplained” variance or “mean within group” variance (second term on the right side). Again, the outer expectations are with regard to <span class="math inline">\(P_y\)</span> and the inner expecations with regard to <span class="math inline">\(P_{x|y}\)</span>.</p>
<div id="exm-meanmixture" class="theorem example">
<p><span class="theorem-title"><strong>Example 13.1</strong></span> Mean and variance of a mixture model:</p>
<p>Assume <span class="math inline">\(K\)</span> groups indicated by a discrete variable <span class="math inline">\(y \in\{ 1, 2, \ldots, K\}\)</span> with probability <span class="math inline">\(p(y) = \pi_y\)</span>. In each group the observations <span class="math inline">\(x\)</span> follow a density <span class="math inline">\(p(x|y)\)</span> with conditional mean <span class="math inline">\(E(x|y) = \mu_y\)</span> and conditional variance <span class="math inline">\(\operatorname{Var}(x| y)= \sigma^2_y\)</span>. The joint density for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is <span class="math inline">\(p(x, y) = \pi_y p(x|y)\)</span>. The marginal density for <span class="math inline">\(x\)</span> is <span class="math inline">\(p(x) = \sum_{y=1}^K \pi_y p(x|y)\)</span>. This is called a mixture model.</p>
<p>The total mean <span class="math inline">\(\operatorname{E}(x) = \mu_0\)</span> is equal to <span class="math display">\[
\mu_0= \sum_{y=1}^K \pi_y \mu_y
\]</span></p>
<p>The total variance <span class="math inline">\(\operatorname{Var}(x) = \sigma^2_0\)</span> is equal to <span class="math display">\[
\sigma^2_0 = \sum_{y=1}^K \pi_y (\mu_y - \mu_0)^2 + \sum_{y=1}^K \pi_y \sigma^2_y
\]</span></p>
</div>
</section>
<section id="conditional-entropy-and-entropy-chain-rules" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="conditional-entropy-and-entropy-chain-rules"><span class="header-section-number">13.4</span> Conditional entropy and entropy chain rules</h2>
<p>Similar to mean and variance one can also define conditional versions of entropies. These lead to decomposition of the joint entropy that are also known as <strong>entropy chain rules</strong>.</p>
<section id="conditional-entropy" class="level3">
<h3 class="anchored" data-anchor-id="conditional-entropy">Conditional entropy</h3>
<p>For the entropy of the joint distribution we find that <span class="math display">\[
\begin{split}
H( P_{x,y}) &amp;= -\operatorname{E}_{P_{x,y}} \log p(x, y) \\
&amp;= -\operatorname{E}_{P_x} \operatorname{E}_{P_{y| x}} (\log p(x) + \log p(y| x))\\
&amp;= -\operatorname{E}_{P_x} \log p(x) - \operatorname{E}_{P_x} \operatorname{E}_{P_{y| x}} \log p(y| x)\\
&amp;= H(P_{x}) + H(P_{y| x} ) \\
\end{split}
\]</span> thus it decomposes into the entropy of the marginal distribution and the <strong>conditional entropy</strong> defined as <span class="math display">\[
H(P_{y| x} ) = - \operatorname{E}_{P_x} \operatorname{E}_{P_{y| x}} \log p(y| x)
\]</span> Note that to simplify notation by convention the expectation <span class="math inline">\(\operatorname{E}_{P_{x}}\)</span> over the variable <span class="math inline">\(x\)</span> that we condition on (<span class="math inline">\(x\)</span>) is implicitly assumed.</p>
</section>
<section id="conditional-cross-entropy" class="level3">
<h3 class="anchored" data-anchor-id="conditional-cross-entropy">Conditional cross-entropy</h3>
<p>Similarly, for the cross-entropy we get <span class="math display">\[
\begin{split}
H(Q_{x,y} , P_{x, y}) &amp;= -\operatorname{E}_{Q_{x,y}} \log  p(x, y) \\
&amp;= -\operatorname{E}_{Q_x} \operatorname{E}_{Q_{y| x}} \log \left(\, p(x)\, p(y| x)\, \right)\\
  &amp;= -\operatorname{E}_{Q_x} \log p(x)    -\operatorname{E}_{Q_x} \operatorname{E}_{Q_{y| x}}  \log  p(y| x)         \\
&amp;= H(Q_x, P_x)  +  H(Q_{y|x}, P_{y|x})
\end{split}
\]</span> where the <strong>conditional cross-entropy</strong> is defined as <span class="math display">\[
H(Q_{y|x}, P_{y|x})= -\operatorname{E}_{Q_x} \operatorname{E}_{Q_{y| x}}  \log  p(y| x)
\]</span> Note again the implicit expectation <span class="math inline">\(\operatorname{E}_{Q_x}\)</span> over <span class="math inline">\(x\)</span> implied in this notation.</p>
</section>
<section id="conditional-kl-divergence" class="level3">
<h3 class="anchored" data-anchor-id="conditional-kl-divergence">Conditional KL divergence</h3>
<p>The KL divergence between the joint distributions can be decomposed as follows: <span class="math display">\[
\begin{split}
D_{\text{KL}}(Q_{x,y} , P_{x, y}) &amp;= \operatorname{E}_{Q_{x,y}} \log \left(\frac{ q(x, y) }{ p(x, y) }\right)\\
&amp;= \operatorname{E}_{Q_x} \operatorname{E}_{Q_{y| x}} \log \left(\frac{ q(x) q(y| x) }{ p(x) p(y| x) }\right)\\
&amp;= \operatorname{E}_{Q_x} \log \left(\frac{ q(x) }{ p(x) }\right)      + \operatorname{E}_{Q_x} \operatorname{E}_{Q_{y| x}}  \log \left(\frac{  q(y| x) }{ p(y| x) }\right)          \\
&amp;= D_{\text{KL}}(Q_{x} , P_{x}) +   D_{\text{KL}}(Q_{y| x} , P_{y|x}) \\
\end{split}
\]</span> with the <strong>conditional KL divergence</strong> defined as <span class="math display">\[
D_{\text{KL}}(Q_{y| x} , P_{y|x})  = \operatorname{E}_{Q_x} \operatorname{E}_{Q_{y| x}}  \log \left(\frac{  q(y| x) }{ p(y| x) }\right)
\]</span> (again the expectation <span class="math inline">\(\operatorname{E}_{Q_{x}}\)</span> is usually dropped for convenience). The conditional KL divergence can also be computed from the conditional (cross-)entropies by the familiar relationship <span class="math display">\[
D_{\text{KL}}(Q_{y| x} , P_{y|x}) = H(Q_{y|x}, P_{y|x})
-  H(Q_{y| x})
\]</span></p>
</section>
<section id="conditional-boltzmann-entropy" class="level3">
<h3 class="anchored" data-anchor-id="conditional-boltzmann-entropy">Conditional Boltzmann entropy</h3>
<p>The Boltzmann entropy is the negative of the KL divergence.</p>
<p>Hence: <span class="math display">\[
\begin{split}
B(Q_{x,y} , P_{x, y})
  &amp;= B(Q_{x} , P_{x}) +   B(Q_{y| x} , P_{y|x}) \\
  &amp;= B(Q_{y} , P_{y}) +   B(Q_{x| y} , P_{x|y}) \\
\end{split}
\]</span></p>
</section>
</section>
<section id="entropy-bounds-for-the-marginal-variables" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="entropy-bounds-for-the-marginal-variables"><span class="header-section-number">13.5</span> Entropy bounds for the marginal variables</h2>
<p>The chain rule for KL divergence directly shows that <span class="math display">\[
\begin{split}
\underbrace{D_{\text{KL}}(Q_{x,y} , P_{x, y})}_{\text{upper bound}} &amp;= D_{\text{KL}}(Q_{x} , P_{x}) + \underbrace{  D_{\text{KL}}(Q_{y| x} , P_{y|x})   }_{\geq 0}\\
&amp;\geq D_{\text{KL}}(Q_{x} , P_{x})
\end{split}
\]</span> This means that the KL divergence between the joint distributions forms an <strong>upper bound for the KL divergence between the marginal distributions</strong>, with the difference given by the conditional KL divergence <span class="math inline">\(D_{\text{KL}}(Q_{y| x} , P_{y|x})\)</span>.</p>
<p>Equivalently, we can state an <strong>upper bound for the marginal cross-entropy</strong>: <span class="math display">\[
\begin{split}
\underbrace{H(Q_{x,y} , P_{x, y}) - H(Q_{y| x} )}_{\text{upper bound}} &amp;= H(Q_{x}, P_{x})  + \underbrace{ D_{\text{KL}}(Q_{y| x} , P_{y|x}) }_{\geq 0}\\
&amp; \geq H(Q_{x}, P_{x}) \\
\end{split}
\]</span> Instead of an upper bound we may as well express this as <strong>lower bound for the negative marginal cross-entropy</strong> <span class="math display">\[.
\begin{split}
- H(Q_{x}, P_{x}) &amp;= \underbrace{ - H(Q_{x} Q_{y| x} , P_{x, y})  + H(Q_{y| x} )}_{\text{lower bound}}  + \underbrace{ D_{\text{KL}}(Q_{y| x} , P_{y|x})}_{\geq 0}\\
&amp; \geq F\left( Q_{x}, Q_{y| x},  P_{x, y}\right)\\
\end{split}
\]</span></p>
<p>Since entropy and KL divergence is closedly linked with maximum likelihood the above bounds play a major role in statistical learning of models with unobserved latent variables (here <span class="math inline">\(y\)</span>). They form the basis of important methods such as the EM algorithm as well as of variational Bayes.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/strimmerlab\.github\.io\/publications\/lecture-notes\/MATH27720-stats2");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12-likelihood6.html" class="pagination-link" aria-label="Optimality properties and conclusion">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Optimality properties and conclusion</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-bayes2.html" class="pagination-link" aria-label="Models with latent variables and missing data">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Models with latent variables and missing data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>