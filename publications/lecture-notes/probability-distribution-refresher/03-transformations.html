<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Probability and Distribution Refresher - 3&nbsp; Transformations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-univariate.html" rel="next">
<link href="./02-probability.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-transformations.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transformations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability and Distribution Refresher</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Combinatorics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-transformations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transformations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Univariate distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-multivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multivariate distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bibliography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#affine-or-location-scale-transformation-of-random-variables" id="toc-affine-or-location-scale-transformation-of-random-variables" class="nav-link active" data-scroll-target="#affine-or-location-scale-transformation-of-random-variables"><span class="header-section-number">3.1</span> Affine or location-scale transformation of random variables</a></li>
  <li><a href="#general-invertible-transformation-of-random-variables" id="toc-general-invertible-transformation-of-random-variables" class="nav-link" data-scroll-target="#general-invertible-transformation-of-random-variables"><span class="header-section-number">3.2</span> General invertible transformation of random variables</a></li>
  <li><a href="#exponential-tilting-and-exponential-families" id="toc-exponential-tilting-and-exponential-families" class="nav-link" data-scroll-target="#exponential-tilting-and-exponential-families"><span class="header-section-number">3.3</span> Exponential tilting and exponential families</a></li>
  <li><a href="#sums-of-random-variables-and-convolution" id="toc-sums-of-random-variables-and-convolution" class="nav-link" data-scroll-target="#sums-of-random-variables-and-convolution"><span class="header-section-number">3.4</span> Sums of random variables and convolution</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transformations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="affine-or-location-scale-transformation-of-random-variables" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="affine-or-location-scale-transformation-of-random-variables"><span class="header-section-number">3.1</span> Affine or location-scale transformation of random variables</h2>
<p>Suppose <span class="math inline">\(x \sim F_x\)</span> is a scalar random variable. The random variable <span class="math display">\[y= a + b x\]</span> is a <strong>location-scale transformation</strong> or <strong>affine transformation</strong> of <span class="math inline">\(x\)</span>, where <span class="math inline">\(a\)</span> plays the role of the <strong>location parameter</strong> and <span class="math inline">\(b\)</span> is the <strong>scale parameter</strong>. For <span class="math inline">\(a=0\)</span> this is a <strong>linear transformation</strong>. If <span class="math inline">\(b\neq 0\)</span> then the transformation is <strong>invertible</strong>, with back-transformation <span class="math display">\[x = (y-a)/b\]</span> Invertible transformations provide a one-to-one map between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>For a random vector <span class="math inline">\(\symbfit x\sim F_{\symbfit x}\)</span> of dimension <span class="math inline">\(d\)</span> the location-scale transformation is <span class="math display">\[
\symbfit y= \symbfit a+ \symbfit B\symbfit x
\]</span> where <span class="math inline">\(\symbfit a\)</span> (a <span class="math inline">\(m \times 1\)</span> vector) is the <strong>location parameter</strong> and <span class="math inline">\(\symbfit B\)</span> (a <span class="math inline">\(m \times d\)</span> matrix) the <strong>scale parameter</strong> For <span class="math inline">\(m=d\)</span> (square <span class="math inline">\(\symbfit B\)</span>) and <span class="math inline">\(\det(\symbfit B) \neq 0\)</span> the affine transformation is <strong>invertible</strong> with back-transformation <span class="math display">\[\symbfit x= \symbfit B^{-1}(\symbfit y-\symbfit a)\]</span></p>
<p>If <span class="math inline">\(x\)</span> is a continuous random variable with density <span class="math inline">\(f_{x}(x)\)</span> and assuming an invertible transformation the density for <span class="math inline">\(y\)</span> is given by <span class="math display">\[
f_{y}(y)=|b|^{-1} f_{x} \left( \frac{y-a}{b}\right)
\]</span> where <span class="math inline">\(|b|\)</span> is the absolute value of <span class="math inline">\(b\)</span>. Likewise, assuming an invertible transformation for a continous random vector <span class="math inline">\(\symbfit x\)</span> with density <span class="math inline">\(f_{\symbfit x}(\symbfit x)\)</span> the density for <span class="math inline">\(\symbfit y\)</span> is given by <span class="math display">\[
f_{\symbfit y}(\symbfit y)=|\det(\symbfit B)|^{-1} f_{\symbfit x} \left( \symbfit B^{-1}(\symbfit y-\symbfit a)\right)
\]</span> where <span class="math inline">\(|\det(\symbfit B)|\)</span> is the absolute value of the determinant <span class="math inline">\(\det(\symbfit B)\)</span>.</p>
<p>The transformed random variable <span class="math inline">\(y \sim F_y\)</span> has mean <span class="math display">\[\text{E}(y) = a + b \mu_x\]</span> and variance <span class="math display">\[\text{Var}(y) = b^2 \sigma^2_x\]</span> where <span class="math inline">\(\text{E}(x) = \mu_x\)</span> and <span class="math inline">\(\text{Var}(x) = \sigma^2_x\)</span> are the mean and variance of the original variable <span class="math inline">\(x\)</span>.</p>
<p>The mean and variance of the transformed random vector <span class="math inline">\(\symbfit y\sim F_{\symbfit y}\)</span> is <span class="math display">\[\text{E}(\symbfit y)=\symbfit a+ \symbfit B\,\symbfit \mu_{\symbfit x}\]</span> and <span class="math display">\[\text{Var}(\symbfit y)= \symbfit B\,\symbfit \Sigma_{\symbfit x} \,\symbfit B^T\]</span> where <span class="math inline">\(\text{E}(\symbfit x)=\symbfit \mu_{\symbfit x}\)</span> and <span class="math inline">\(\text{Var}(\symbfit x)=\symbfit \Sigma_{\symbfit x}\)</span> are the mean and variance of the original random vector <span class="math inline">\(\symbfit x\)</span>.</p>
<p>The constants <span class="math inline">\(\symbfit a\)</span> and <span class="math inline">\(\symbfit B\)</span> (or <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> in the univariate case) are the parameters of the <strong>location-scale family</strong> <span class="math inline">\(F_{\symbfit y}\)</span> created from <span class="math inline">\(F_{\symbfit x}\)</span>. Many important distributions are location-scale families such as the normal distribution (cf. <a href="05-multivariate.html#sec-mvnormaldist" class="quarto-xref"><span>Section 5.4</span></a> and <a href="05-multivariate.html#sec-mvnormaldist" class="quarto-xref"><span>Section 5.4</span></a>) and the location-scale <span class="math inline">\(t\)</span>-distribution (<a href="04-univariate.html#sec-locscalet" class="quarto-xref"><span>Section 4.7.1</span></a>). Furthermore, key procedures in multivariate statistics such as orthogonal transformations (including PCA) or whitening transformations (e.g.&nbsp;the Mahalanobis transformation) are affine transformations.</p>
</section>
<section id="general-invertible-transformation-of-random-variables" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="general-invertible-transformation-of-random-variables"><span class="header-section-number">3.2</span> General invertible transformation of random variables</h2>
<p>As above we assume <span class="math inline">\(x \sim F_x\)</span> is a scalar random variable and <span class="math inline">\(\symbfit x\sim F_{\symbfit x}\)</span> is a random vector.</p>
<p>As a generalisation of invertible affine transformations we now consider general invertible transformations. For a scalar random variable we assume the transformation is specified by <span class="math inline">\(y(x) = h(x)\)</span> and the back-transformation by <span class="math inline">\(x(y) = h^{-1}(y)\)</span> For a random vector we assume <span class="math inline">\(\symbfit y(\symbfit x) = \symbfit h(\symbfit x)\)</span> is invertible with backtransformation <span class="math inline">\(\symbfit x(\symbfit y) = \symbfit h^{-1}(\symbfit y)\)</span>.</p>
<p>If <span class="math inline">\(x\)</span> is a continuous random variable with density <span class="math inline">\(f_{x}(x)\)</span> the density of the transformed variable <span class="math inline">\(y\)</span> can be computed exactly and is given by <span class="math display">\[
f_y(y) =\left| D x(y) \right|\, f_x(x(y))
\]</span> where <span class="math inline">\(D x(y)\)</span> is the derivative of the inverse transformation <span class="math inline">\(x(y)\)</span>.</p>
<p>Likewise, for a continuous random vector <span class="math inline">\(\symbfit x\)</span> with density <span class="math inline">\(f_{\symbfit x}(\symbfit x)\)</span> the density for <span class="math inline">\(\symbfit y\)</span> is obtained by <span class="math display">\[
f_{\symbfit y}(\symbfit y) = |\det\left( D\symbfit x(\symbfit y) \right)| \,\,  f_{\symbfit x}\left( \symbfit x(\symbfit y) \right)
\]</span> where <span class="math inline">\(D\symbfit x(\symbfit y)\)</span> is the Jacobian matrix of the inverse transformation <span class="math inline">\(\symbfit x(\symbfit y)\)</span>.</p>
<p>The mean and variance of the transformed random variable can typically only be approximated. Assume that <span class="math inline">\(\text{E}(x) = \mu_x\)</span> and <span class="math inline">\(\text{Var}(x) = \sigma^2_x\)</span> are the mean and variance of the original random variable <span class="math inline">\(x\)</span> and <span class="math inline">\(\text{E}(\symbfit x)=\symbfit \mu_{\symbfit x}\)</span> and <span class="math inline">\(\text{Var}(\symbfit x)=\symbfit \Sigma_{\symbfit x}\)</span> are the mean and variance of the original random vector <span class="math inline">\(\symbfit x\)</span>. In the <strong>delta method</strong> the transformation <span class="math inline">\(y(x)\)</span> resp. <span class="math inline">\(\symbfit y(\symbfit x)\)</span> is linearised around the mean <span class="math inline">\(\mu_x\)</span> respectively <span class="math inline">\(\symbfit \mu_{\symbfit x}\)</span> and the mean and variance resulting from the linear transformation is reported.</p>
<p>Specifically, the linear approximation for the scalar-valued function is <span class="math display">\[
y(x) \approx y\left(\mu_x\right) + D y\left(\mu_x\right)\, \left(x-\mu_x\right)
\]</span> where <span class="math inline">\(D y(x) = y'(x)\)</span> is the first derivative of the transformation <span class="math inline">\(y(x)\)</span> and <span class="math inline">\(D y\left(\mu_x\right)\)</span> is the first derivative evaluated at the mean <span class="math inline">\(\mu_x\)</span>, and for the vector-valued function <span class="math display">\[
\symbfit y(\symbfit x) \approx \symbfit y\left(\symbfit \mu_{\symbfit x}\right) + D \symbfit y\left(\symbfit \mu_{\symbfit x}\right) \, \left(\symbfit x-\symbfit \mu_{\symbfit x}\right)
\]</span> where <span class="math inline">\(D \symbfit y(\symbfit x)\)</span> is the Jacobian matrix (vector derivative) for the transformation <span class="math inline">\(\symbfit y(\symbfit x)\)</span> and <span class="math inline">\(D \symbfit y\left(\symbfit \mu_{\symbfit x}\right)\)</span> is the Jacobian matrix evaluated at the mean <span class="math inline">\(\symbfit \mu_{\symbfit x}\)</span>.</p>
<p>In the univariate case the delta method yields as approximation for the mean and variance of the transformed random variable <span class="math inline">\(y\)</span> <span class="math display">\[
\text{E}(y) \approx y\left(\mu_x\right)
\]</span> and <span class="math display">\[
\text{Var}(y)\approx \left(D y\left(\mu_x\right)\right)^2 \, \sigma^2_x  
\]</span></p>
<p>For the vector random variable <span class="math inline">\(\symbfit y\)</span> the delta method yields <span class="math display">\[\text{E}(\symbfit y)\approx\symbfit y\left(\symbfit \mu_{\symbfit x}\right)\]</span> and <span class="math display">\[
\text{Var}(\symbfit y)\approx D \symbfit y\left(\symbfit \mu_{\symbfit x}\right) \, \symbfit \Sigma_{\symbfit x} \, D\symbfit y\left(\symbfit \mu_{\symbfit x}\right)^T
\]</span></p>
<p>Assuming <span class="math inline">\(y(x) = a + b x\)</span>, with <span class="math inline">\(x(y) = (y-a)/b\)</span>, <span class="math inline">\(D y(x) = b\)</span> and <span class="math inline">\(D x(y) = b^{-1}\)</span>, recovers the univariate location-scale transformation. Likewise, assuming <span class="math inline">\(\symbfit y(\symbfit x) = \symbfit a+ \symbfit B\symbfit x\)</span>, with <span class="math inline">\(\symbfit x(\symbfit y) = \symbfit B^{-1}(\symbfit y-\symbfit a)\)</span>, <span class="math inline">\(D\symbfit y(\symbfit x) = \symbfit B\)</span> and <span class="math inline">\(D\symbfit x(\symbfit y) = \symbfit B^{-1}\)</span>, recovers the multivariate location-scale transformation.</p>
</section>
<section id="exponential-tilting-and-exponential-families" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="exponential-tilting-and-exponential-families"><span class="header-section-number">3.3</span> Exponential tilting and exponential families</h2>
<p>Another way to change the distribution of a random variable is by <strong>exponential tilting</strong>.</p>
<p>Suppose there is a vector valued function <span class="math inline">\(\symbfit u(x)\)</span> where each component is a transformation of <span class="math inline">\(x\)</span>, usually a simple function such the identity <span class="math inline">\(x\)</span>, the square <span class="math inline">\(x^2\)</span>, the logarithm <span class="math inline">\(\log(x)\)</span> etc. These are called the <strong>canonical statistics</strong>. Typically, the dimension of <span class="math inline">\(\symbfit u(x)\)</span> is small.</p>
<p>The exponential tilt of a <strong>base distribution</strong> <span class="math inline">\(B\)</span> with density or probability mass function <span class="math inline">\(b(x)\)</span> towards the linear combination <span class="math inline">\(\symbfit \eta^T \symbfit u(x)\)</span> of the canonical statistics <span class="math inline">\(\symbfit u(x)\)</span> yields the distribution family <span class="math inline">\(P_{\symbfit \eta}\)</span> with density or probability mass function <span class="math display">\[
p(x|\symbfit \eta) =    \underbrace{e^{ \symbfit \eta^T \symbfit u(x)}}_{\text{exponential tilt}}\, b(x) \, /\, e^{ \psi(\symbfit \eta)}
\]</span> where <span class="math inline">\(\symbfit \eta\)</span> are the canonical parameters. The normalising factor <span class="math inline">\(e^{ \psi(\symbfit \eta)}\)</span> ensures that <span class="math inline">\(p(x|\symbfit \eta)\)</span> integrates to one following the exponential tilt.</p>
<p>The corresponding log-density / log probability mass function is <span class="math display">\[
\log p(x|\symbfit \eta) =  \symbfit \eta^T \symbfit u(x) + \log b(x) - \psi(\symbfit \eta)
\]</span> The <strong>log-normaliser</strong> or <strong>log-partition function</strong> <span class="math inline">\(\psi(\symbfit \eta)\)</span> is obtained by computing <span class="math display">\[
\psi(\symbfit \eta) = \log \int_x \, e^{ \symbfit \eta^T \symbfit u(x)}\, b(x) \, dx
\]</span> The set of values of <span class="math inline">\(\symbfit \eta\)</span> for which the integral is finite and hence <span class="math inline">\(\psi(\symbfit \eta) &lt; \infty\)</span> defines the parameter space.</p>
<p>The distribution family <span class="math inline">\(P_{\symbfit \eta}\)</span> obtained by exponential tiling is called an <strong>exponential family</strong>.</p>
<p>Many commonly used distribution families are exponential families (most importantly the normal distribution). Exponential families are extremely important in probability and statistics. They provide highly effective models for statistical learning using entropy, likelihood and Bayesian approaches, allow for substantial data reduction via minimal sufficiency, and provide the basis of generalised linear models. Furthermore, exponential families often enable to generalise probabilistic results valid for the normal distribution to more general settings.</p>
</section>
<section id="sums-of-random-variables-and-convolution" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sums-of-random-variables-and-convolution"><span class="header-section-number">3.4</span> Sums of random variables and convolution</h2>
<p>Suppose we have a sum of <span class="math inline">\(n\)</span> independent and identically distributed (iid) random variables. <span class="math display">\[
y = x_1 + x_2 + \ldots + x_n
\]</span> where each <span class="math inline">\(x_i \sim F_x\)</span> with density or probability mass function <span class="math inline">\(f_x(x)\)</span>. The density or probability mass function for <span class="math inline">\(y\)</span> is obtained by repeated application of <strong>convolution</strong> (symbolised by the <span class="math inline">\(\ast\)</span> operator): <span class="math display">\[
f_y(y) = \left(f_{x_1} \ast f_{x_2} \ast \ldots f_{x_n}\right)(y)
\]</span></p>
<p>The convolution of two functions is defined as (continuous case) <span class="math display">\[
\left(f_{x_1}\ast f_{x_2}\right)(y)=\int_x f_{x_1}(x)\, f_{x_2}(y-x) dx
\]</span> and (discrete case) <span class="math display">\[
\left(f_{x_1}\ast f_{x_2}\right)(y)=\sum_x f_{x_1}(x)\, f_{x_2}(y-x)
\]</span> Convolution is commutative and associative so it can be applied in any order to compute the convolution of multiple functions. Furthermore, the convolution of probability densities / mass function yields another probability density / mass function.</p>
<p>Many commonly used random variables can be viewed as the outcome of convolutions. For example, the sum of Bernoulli variables yields a binomial random variable and the sum of normal variables yields another normal random variable.</p>
<p>See also: <a href="https://en.wikipedia.org/wiki/List_of_convolutions_of_probability_distributions">list of convolutions of probability distributions</a>.</p>
<p>The <strong>central limit theorem</strong>, first postulated by <a href="https://en.wikipedia.org/wiki/Abraham_de_Moivre">Abraham de Moivre (1667–1754)</a> and later proved by <a href="https://en.wikipedia.org/wiki/Pierre-Simon_Laplace">Pierre-Simon Laplace (1749–1827)</a> asserts that, under appropriate conditions, the distribution of the sum of independent and identically distributed random variables converges in the limit of large <span class="math inline">\(n\)</span> to a normal distribution (<a href="04-univariate.html#sec-normaldist" class="quarto-xref"><span>Section 4.4</span></a>), even if the individual random variables are not normal. In other words, it asserts that for large <span class="math inline">\(n\)</span> the convolution of <span class="math inline">\(n\)</span> identical distributions typically converges to the normal distribution.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/strimmerlab\.github\.io\/publications\/lecture-notes\/probability-distribution-refresher\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-probability.html" class="pagination-link" aria-label="Probability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-univariate.html" class="pagination-link" aria-label="Univariate distributions">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Univariate distributions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>These notes were written by <a href="https://strimmerlab.github.io/korbinian.html">Korbinian Strimmer</a> using <a href="https://quarto.org">Quarto</a>,</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>