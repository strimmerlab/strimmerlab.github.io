<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Probability and Distribution Refresher - 5&nbsp; Multivariate distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-univariate.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-multivariate.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multivariate distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability and Distribution Refresher</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Combinatorics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transformations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Univariate distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-multivariate.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multivariate distributions</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#categorical-distribution" id="toc-categorical-distribution" class="nav-link active" data-scroll-target="#categorical-distribution"><span class="header-section-number">5.1</span> Categorical distribution</a></li>
  <li><a href="#multinomial-distribution" id="toc-multinomial-distribution" class="nav-link" data-scroll-target="#multinomial-distribution"><span class="header-section-number">5.2</span> Multinomial distribution</a></li>
  <li><a href="#dirichlet-distribution" id="toc-dirichlet-distribution" class="nav-link" data-scroll-target="#dirichlet-distribution"><span class="header-section-number">5.3</span> Dirichlet distribution</a>
  <ul class="collapse">
  <li><a href="#standard-parameterisation" id="toc-standard-parameterisation" class="nav-link" data-scroll-target="#standard-parameterisation"><span class="header-section-number">5.3.1</span> Standard parameterisation</a></li>
  <li><a href="#mean-parameterisation" id="toc-mean-parameterisation" class="nav-link" data-scroll-target="#mean-parameterisation"><span class="header-section-number">5.3.2</span> Mean parameterisation</a></li>
  </ul></li>
  <li><a href="#multivariate-normal-distribution" id="toc-multivariate-normal-distribution" class="nav-link" data-scroll-target="#multivariate-normal-distribution"><span class="header-section-number">5.4</span> Multivariate normal distribution</a></li>
  <li><a href="#wishart-distribution" id="toc-wishart-distribution" class="nav-link" data-scroll-target="#wishart-distribution"><span class="header-section-number">5.5</span> Wishart distribution</a></li>
  <li><a href="#inverse-wishart-distribution" id="toc-inverse-wishart-distribution" class="nav-link" data-scroll-target="#inverse-wishart-distribution"><span class="header-section-number">5.6</span> Inverse Wishart distribution</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multivariate distributions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="categorical-distribution" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="categorical-distribution"><span class="header-section-number">5.1</span> Categorical distribution</h2>
<p>The <strong>categorical distribution</strong> is a generalisation of the Bernoulli distribution from two classes to <span class="math inline">\(K\)</span> classes.</p>
<p>The categorical distribution <span class="math inline">\(\text{Cat}(\symbfit \pi)\)</span> describes a discrete random variable with <span class="math inline">\(K\)</span> states (“categories”, “classes”, “bins”) where the parameter vector <span class="math inline">\(\symbfit \pi= (\pi_1, \ldots, \pi_K)^T\)</span> specifies the probability of each of class so that <span class="math inline">\(\text{Pr}(\text{"class k"}) = \pi_k\)</span>. The parameters satisfy <span class="math inline">\(\pi_k \in [0,1]\)</span> and <span class="math inline">\(\sum_{k=1}^K \pi_k = 1\)</span>, hence there are <span class="math inline">\(K-1\)</span> independent parameters in a categorical distribution (and not <span class="math inline">\(K\)</span>).</p>
<p>There are two main ways to numerically represent “class k”:</p>
<ol type="i">
<li>by “integer encoding”, i.e.&nbsp;by the corresponding integer <span class="math inline">\(k\)</span>.</li>
<li>by “one hot encoding”, i.e.&nbsp;by an indicator vector <span class="math inline">\(\symbfit x= (x_1, \ldots, x_K)^T = (0, 0, \ldots, 1, \ldots, 0)^T\)</span> containing zeros everywhere except for the element <span class="math inline">\(x_k=1\)</span> at position <span class="math inline">\(k\)</span>. Thus all <span class="math inline">\(x_k \in \{ 0, 1\}\)</span> and <span class="math inline">\(\sum_{k=1}^K x_k = 1\)</span>.</li>
</ol>
<p>In the following we use “one hot encoding”. Therefore sampling from a categorical distribution with parameters <span class="math inline">\(\symbfit \pi\)</span> <span class="math display">\[
\symbfit x\sim \text{Cat}(\symbfit \pi)
\]</span> yields a random index vector <span class="math inline">\(\symbfit x\)</span>.</p>
<p>The corresponding probability mass function (PMF) can be written conveniently in terms of <span class="math inline">\(x_k\)</span> as <span class="math display">\[
p(\symbfit x| \symbfit \pi) = \prod_{k=1}^K \pi_k^{x_k} =
\begin{cases}
   \pi_k  &amp; \text{if } x_k = 1 \\
\end{cases}
\]</span> and the log PMF as <span class="math display">\[
\log p(\symbfit x| \symbfit \pi) = \sum_{k=1}^K x_k \log \pi_k   =
\begin{cases}
   \log \pi_k  &amp; \text{if } x_k = 1 \\
\end{cases}
\]</span></p>
<p>In order to be more explicit that the categorical distribution has <span class="math inline">\(K-1\)</span> and not <span class="math inline">\(K\)</span> parameters we rewrite the log-density with <span class="math inline">\(\pi_K = 1 - \sum_{k=1}^{K-1} \pi_k\)</span> and <span class="math inline">\(x_K = 1 - \sum_{k=1}^{K-1} x_k\)</span> as <span class="math display">\[
\begin{split}
\log p(\symbfit x| \symbfit \pi) &amp; =\sum_{k=1}^{K-1}  x_k \log \pi_k    + x_K \log \pi_K \\
&amp; =\sum_{k=1}^{K-1}  x_k \log \pi_k    + \left( 1 - \sum_{k=1}^{K-1} x_k  \right) \log \left( 1 - \sum_{k=1}^{K-1} \pi_k \right) \\
\end{split}
\]</span> Note that there is no particular reason to choose <span class="math inline">\(\pi_K\)</span> as dependent of the probabilities of the other classes, in its place any other of the <span class="math inline">\(\pi_k\)</span> may be selected.</p>
<p>The expected value is <span class="math inline">\(\text{E}(\symbfit x) = \symbfit \pi\)</span>, in component notation <span class="math inline">\(\text{E}(x_k) = \pi_k\)</span>. The covariance matrix is <span class="math inline">\(\text{Var}(\symbfit x) = \text{Diag}(\symbfit \pi) - \symbfit \pi\symbfit \pi^T\)</span>, which in component notation is <span class="math inline">\(\text{Var}(x_i) = \pi_i (1-\pi_i)\)</span> and <span class="math inline">\(\text{Cov}(x_i, x_j) = -\pi_i \pi_j\)</span>.</p>
<p>The form of the categorical covariance matrix follows directly from the definition of the variance <span class="math inline">\(\text{Var}(\symbfit x) = \text{E}( \symbfit x\symbfit x^T) - \text{E}( \symbfit x) \text{E}( \symbfit x)^T\)</span> and noting that <span class="math inline">\(x_i^2 = x_i\)</span> and <span class="math inline">\(x_i x_j = 0\)</span> if <span class="math inline">\(i \neq j\)</span>. Furthermore, the categorical covariance matrix is singular by construction, as the <span class="math inline">\(K\)</span> random variables <span class="math inline">\(x_1, \ldots, x_K\)</span> are dependent through the constraint <span class="math inline">\(\sum_{k=1}^K x_k = 1\)</span>.</p>
<p>For <span class="math inline">\(K=2\)</span> the categorical distribution reduces to the Bernoulli <span class="math inline">\(\text{Ber}(\theta)\)</span> distribution, with <span class="math inline">\(\pi_1=\theta\)</span> and <span class="math inline">\(\pi_2=1-\theta\)</span>.</p>
</section>
<section id="multinomial-distribution" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="multinomial-distribution"><span class="header-section-number">5.2</span> Multinomial distribution</h2>
<p>The <strong>multinomial distribution</strong> <span class="math inline">\(\text{Mult}(n, \symbfit \pi)\)</span> arises from repeated categorical sampling, in the same fashion as the binomial distribution arises from repeated Bernoulli sampling. Thus, if <span class="math inline">\(\symbfit x_1, \ldots, \symbfit x_n\)</span> are <span class="math inline">\(n\)</span> independent <span class="math inline">\(\text{Cat}(\symbfit \pi)\)</span> random categorical variables then <span class="math inline">\(\symbfit y= \sum_{i=1}^n \symbfit x_i\)</span> is distributed as <span class="math inline">\(\text{Mult}(n, \symbfit \pi)\)</span>.</p>
<p>The corresponding PMF describes the probability of a pattern <span class="math inline">\(y_1, \ldots, y_K\)</span> of samples distributed across <span class="math inline">\(K\)</span> classes (with <span class="math inline">\(n= \sum_{k=1}^K y_k\)</span>): <span class="math display">\[
p(\symbfit y| n, \theta) = \binom{n}{y_1, \ldots, y_n} \prod_{k=1}^K \pi_k^{y_k}
\]</span> where <span class="math inline">\(\binom{n}{y_1, \ldots, y_n}\)</span> is the multinomial coefficient.</p>
<p>The expected value is <span class="math display">\[\text{E}(\symbfit y) = n \symbfit \pi\]</span> which in component notation is <span class="math inline">\(\text{E}(y_k) = n \pi_k\)</span>. The covariance matrix is <span class="math display">\[\text{Var}(\symbfit y) = n (\text{Diag}(\symbfit \pi) - \symbfit \pi\symbfit \pi^T)
\]</span> which in component notation is <span class="math inline">\(\text{Var}(x_i) = n \pi_i (1-\pi_i)\)</span> and <span class="math inline">\(\text{Cov}(x_i, x_j) = -n \pi_i \pi_j\)</span>.</p>
<p>Standardised to unit interval we get: <span class="math display">\[\frac{y_i}{n} \in \left\{0,\frac{1}{n},\frac{2}{n},...,1\right\}\]</span> <span class="math display">\[\text{E}\left(\frac{\symbfit y}{n}\right) = \symbfit \pi\]</span> <span class="math display">\[\text{Var}\left(\frac{\symbfit y}{n}\right) = \frac{ \text{Diag}(\symbfit \pi)-\symbfit \pi\symbfit \pi^T}{n}\]</span> <span class="math display">\[\text{Var}\left(\frac{y_i}{n}\right)=\frac{\pi_i(1-\pi_i)}{n}\]</span> <span class="math display">\[\text{Cov}\left(\frac{y_i}{n},\frac{y_j}{n}\right)=-\frac{\pi_i\pi_j}{n} \]</span></p>
<p>The multinomial distribution may be illustrated by an urn model distributing <span class="math inline">\(n\)</span> balls into <span class="math inline">\(K\)</span> bins:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig/urn-multinom.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>For <span class="math inline">\(n=1\)</span> the multinomial distribution reduces to the categorical distribution.</p>
<p>For <span class="math inline">\(K=2\)</span> the multinomial distribution reduces to the Binomial distribution.</p>
</section>
<section id="dirichlet-distribution" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="dirichlet-distribution"><span class="header-section-number">5.3</span> Dirichlet distribution</h2>
<section id="standard-parameterisation" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="standard-parameterisation"><span class="header-section-number">5.3.1</span> Standard parameterisation</h3>
<p>The Dirichlet distribution is the multivariate generalisation of the beta distribution.</p>
<p>A Dirichlet distributed random vector is denoted by <span class="math display">\[
\symbfit x\sim \text{Dir}(\symbfit \alpha)
\]</span> with parameter <span class="math inline">\(\symbfit \alpha= (\alpha_1,...,\alpha_K)^T &gt;0\)</span> and <span class="math inline">\(K\geq 2\)</span> and where the support of <span class="math inline">\(\symbfit x\)</span> is the <span class="math inline">\(K-1\)</span> dimensional simplex with <span class="math inline">\(x_i \in [0,1]\)</span> and <span class="math inline">\(\sum^{K}_{i=1} x_i = 1\)</span>.</p>
<p>The Dirichlet random variable can be visualised as breaking a unit stick of length one in <span class="math inline">\(K\)</span> pieces of length <span class="math inline">\(x_1\)</span> to <span class="math inline">\(x_K\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig/stick-dirichlet.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>The density of the Dirichlet distribution <span class="math inline">\(\text{Dir}(\symbfit \alpha)\)</span> is <span class="math display">\[
p(\symbfit x| \symbfit \alpha) = \frac{1}{B(\symbfit \alpha)}  \prod_{k=1}^K x_k^{\alpha_k-1}
\]</span> This depends on the beta function with multivariate argument defined as <span class="math display">\[
B(\symbfit z) = \frac{ \prod_{k=1}^K \Gamma(z_k) }{\Gamma\left( \sum_{k=1}^K   z_k\right)}
\]</span></p>
<p>For <span class="math inline">\(K=2\)</span> the Dirichlet distribution reduces to the beta distribution.</p>
</section>
<section id="mean-parameterisation" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="mean-parameterisation"><span class="header-section-number">5.3.2</span> Mean parameterisation</h3>
<p>Instead of employing <span class="math inline">\(\symbfit \alpha\)</span> as parameter vector another useful reparameterisation <span class="math inline">\(\text{Dir}(\symbfit \pi, k)\)</span> of the Dirichlet distribution is in terms of a mean parameter <span class="math inline">\(\symbfit \pi\)</span>, with <span class="math inline">\(\pi_i \in [0,1]\)</span> and <span class="math inline">\(\sum^{K}_{i=1}\pi_i = 1\)</span>, and a concentration parameter <span class="math inline">\(k &gt; 0\)</span>. These are given by <span class="math display">\[
k = \sum^{K}_{i=1}\alpha_i
\]</span> and <span class="math display">\[
\symbfit \pi= \frac{\symbfit \alpha}{k}
\]</span> The original parameters can be recovered by <span class="math inline">\(\alpha= \symbfit \pi k\)</span>.</p>
<p>The mean and variance of the Dirichlet distribution expressed in terms of <span class="math inline">\(\symbfit \pi\)</span> and <span class="math inline">\(k\)</span> are <span class="math display">\[
\text{E}(\symbfit x) = \symbfit \pi
\]</span> and <span class="math display">\[\text{Var}\left(\symbfit x\right) = \frac{ \text{Diag}(\symbfit \pi)-\symbfit \pi\symbfit \pi^T}{k+1}\]</span> which in component notation is <span class="math display">\[\text{Var}(x_i)=\frac{\pi_i(1-\pi_i)}{k+1}\]</span> and <span class="math display">\[\text{Cov}(x_i,x_j)=-\frac{\pi_i \pi_j}{k+1}\]</span></p>
<p>Finally, note that the mean and variance of the continuous Dirichlet distribution closely match those of the unit-standardised discrete multinomial distribution above.</p>
</section>
</section>
<section id="multivariate-normal-distribution" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="multivariate-normal-distribution"><span class="header-section-number">5.4</span> Multivariate normal distribution</h2>
<p>The univariate normal distribution for a random scalar <span class="math inline">\(x\)</span> generalises to the <strong>multivariate normal distribution</strong> for a random vector <span class="math inline">\(\symbfit x= (x_1, x_2,...,x_d)^T\)</span>.</p>
<p>If <span class="math inline">\(\symbfit x\)</span> follows a multivariate normal distribution we write <span class="math display">\[
\symbfit x\sim N_d(\symbfit \mu, \symbfit \Sigma)
\]</span> where <span class="math inline">\(\symbfit \mu\)</span> is the mean (location) parameter and <span class="math inline">\(\symbfit \Sigma\)</span> the variance (scale) parameter.</p>
<p>The corresponding density is</p>
<p><span class="math display">\[
p(\symbfit x| \symbfit \mu, \symbfit \Sigma) = \det(2 \pi \symbfit \Sigma)^{-1/2} \exp\left(-\frac{1}{2} (\symbfit x-\symbfit \mu)^T \symbfit \Sigma^{-1} (\symbfit x-\symbfit \mu)   \right)
\]</span></p>
<p>As <span class="math inline">\(\det(2 \pi \symbfit \Sigma)^{-1/2} = \det(2 \pi \symbfit I_d)^{-1/2} \det(\symbfit \Sigma)^{-1/2} =  (2 \pi)^{-d/2} \det(\symbfit \Sigma)^{-1/2}\)</span> the density can also be written as <span class="math display">\[
p(\symbfit x| \symbfit \mu, \symbfit \Sigma) = (2\pi)^{-d/2} \det(\symbfit \Sigma)^{-1/2} \exp\left(-\frac{1}{2} (\symbfit x-\symbfit \mu)^T \symbfit \Sigma^{-1} (\symbfit x-\symbfit \mu)   \right)
\]</span> i.e.&nbsp;with explicit occurence of the dimension <span class="math inline">\(d\)</span>.</p>
<p>The expectation of <span class="math inline">\(\symbfit x\)</span> is <span class="math inline">\(\text{E}(\symbfit x) = \symbfit \mu\)</span> and the variance is <span class="math inline">\(\text{Var}(\symbfit x) = \symbfit \Sigma\)</span>.</p>
<p>For <span class="math inline">\(d=1\)</span> the random vector <span class="math inline">\(\symbfit x=x\)</span> is a scalar and <span class="math inline">\(\symbfit \mu= \mu\)</span> and <span class="math inline">\(\symbfit \Sigma= \sigma^2\)</span> and the multivariate normal density reduces to the univariate normal density.</p>
</section>
<section id="wishart-distribution" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="wishart-distribution"><span class="header-section-number">5.5</span> Wishart distribution</h2>
<p>The Wishart distribution is a multivariate generalisation of the gamma distribution.</p>
<p>Recall that the gamma distribution can be motivated as the distribution of sums of squared normal random variables. Likewise, the Wishart distribution can be understood as the sum of squared multivariate normal variables: <span class="math display">\[
\symbfit z_1,\symbfit z_2,\ldots,\symbfit z_k \stackrel{\text{iid}}\sim N_d(0,\symbfit S)
\]</span><br>
with <span class="math inline">\(\symbfit S=(s_{ij})\)</span> the specified covariance matrix. The random variable <span class="math display">\[\underbrace{\symbfit X}_{d\times d}=\sum^{k}_{i=1}\underbrace{\symbfit z_i\symbfit z_i^T}_{d\times d}\]</span><br>
is a random <em>matrix</em> and is distributed as <span class="math display">\[
\symbfit X\sim  \text{W}_d\left(\symbfit S, k\right)
\]</span> with mean <span class="math display">\[
\text{E}(\symbfit X) = k \symbfit S
\]</span> and variances <span class="math display">\[
\text{Var}(x_{ij})  = k \left(s^2_{ij}+s_{ii} s_{jj}  \right)
\]</span></p>
<p>We often also employ the Wishart distribution in <strong>mean parameterisation</strong> <span class="math display">\[
\text{W}_d\left(\symbfit S= \frac{\symbfit M}{k}, k \right)
\]</span> with parameters <span class="math inline">\(\symbfit M= k \symbfit S\)</span> and <span class="math inline">\(k\)</span>. In this parameterisation the mean is <span class="math display">\[
\text{E}(\symbfit X) = \symbfit M= (\mu_{ij})
\]</span> and variances are <span class="math display">\[
\text{Var}(x_{ij})  = \frac{ \mu^2_{ij}+\mu_{ii}\mu_{jj} }{k}
\]</span></p>
<p>If <span class="math inline">\(\symbfit S\)</span> or <span class="math inline">\(\symbfit M\)</span> is a scalar rather than a matrix then the multivariate Wishart distribution reduces to the univariate Wishart aka gamma distribution.</p>
</section>
<section id="inverse-wishart-distribution" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="inverse-wishart-distribution"><span class="header-section-number">5.6</span> Inverse Wishart distribution</h2>
<p>The inverse Wishart distribution is a multivariate generalisation of the inverse gamma distribution and is linked to the Wishart distribution.</p>
<p>A random matrix <span class="math inline">\(\symbfit X\)</span> following an <strong>inverse Wishart distribution</strong> is denoted by <span class="math display">\[
\symbfit X\sim \text{W}^{-1}_d\left(\symbfit \Psi, \nu\right)
\]</span> where <span class="math inline">\(\symbfit \Psi\)</span> is the scale parameter and <span class="math inline">\(\nu\)</span> the shape parameter. The corresponding mean is given by <span class="math display">\[
\text{E}(\symbfit X) = \frac{\symbfit \Psi}{\nu-d-1}
\]</span> and the variances are <span class="math display">\[
\text{Var}(x_{ij})= \frac{(\nu-d+1) \psi_{ij}^2 + (\nu-d-1) \, \psi_{ii} \psi_{jj} }{(\nu-d)(\nu-d-1)^2(\nu-d-3)}
\]</span></p>
<p>The inverse of <span class="math inline">\(\symbfit X\)</span> is then Wishart distributed: <span class="math display">\[
\symbfit X^{-1} \sim \text{W}_d\left( \symbfit S= \symbfit \Psi^{-1}   \, , k = \nu \right)
\]</span></p>
<p>Instead of <span class="math inline">\(\symbfit \Psi\)</span> and <span class="math inline">\(\nu\)</span> we may use the mean parameterisation with parameters <span class="math inline">\(\kappa = \nu-d-1\)</span> and <span class="math inline">\(\symbfit M= \symbfit \Psi/(\nu-d-1)\)</span>: <span class="math display">\[
\symbfit X\sim \text{W}^{-1}_d\left(\symbfit \Psi=  \kappa  \symbfit M\, , \, \nu= \kappa+d+1\right)
\]</span> with mean <span class="math display">\[
\text{E}(\symbfit X) =\symbfit M
\]</span> and variances <span class="math display">\[
\text{Var}(x_{ij})= \frac{(\kappa+2) \mu_{ij}^2 + \kappa \, \mu_{ii} \mu_{jj} }{(\kappa + 1)(\kappa-2)}
\]</span></p>
<p>If <span class="math inline">\(\symbfit \Psi\)</span> or <span class="math inline">\(\symbfit M\)</span> is a scalar rather than a matrix then the multivariate inverse Wishart distribution reduces to the univariate inverse Wishart aka inverse gamma distribution.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/strimmerlab\.github\.io\/publications\/lecture-notes\/probability-distribution-refresher\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-univariate.html" class="pagination-link" aria-label="Univariate distributions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Univariate distributions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>These notes were written by <a href="https://strimmerlab.github.io/korbinian.html">Korbinian Strimmer</a> using <a href="https://quarto.org">Quarto</a>,</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>